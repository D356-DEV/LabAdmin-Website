<div class="container-fluid py-5">
    @if (user) {
    <ng-container *ngTemplateOutlet="ready"></ng-container>
    } @else{
    <ng-container *ngTemplateOutlet="loading"></ng-container>
    }
</div>

<ng-template #ready>
    <div class="container-lg">
        <div class="card bg-warning-subtle">
            <div class="card-body" style="min-height: 450px">
                @switch (activeScreen) { @case ('information') {
                <ng-container *ngTemplateOutlet="information"></ng-container>
                } @case ('security') {
                <ng-container *ngTemplateOutlet="security"></ng-container>
                } }
            </div>

            <div class="card-footer">
                <div class="row gap-1">
                    <div class="col">
                        <button type="button" class="btn btn-warning rounded-pill w-100 h-100"
                            (click)="setActiveScreen('information')">
                            <i class="bi bi-person"></i> Información
                        </button>
                    </div>
                    <div class="col">
                        <button type="button" class="btn btn-warning rounded-pill w-100 h-100"
                            (click)="setActiveScreen('security')">
                            <i class="bi bi-key"></i> Seguridad
                        </button>
                    </div>
                    <div class="col">
                        <button type="button" class="btn btn-danger rounded-pill w-100 h-100" (click)="logOut()">
                            <i class="bi bi-box-arrow-right"></i> Salir
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (isAdmin) {
    <!-- LAB LIST -->
    <div class="container-lg mt-5">
        <div class="card shadow">
            <div class="card-header bg-warning-subtle">
                <div class="row">
                    <div class="col-7 col-4 d-flex align-items-center justify-content-start">
                        <h3>Laboratorios</h3>
                    </div>
                    <div class="col-5 d-flex align-items-center justify-content-center">
                        <button type="button" class="btn btn-warning w-100 rounded-pill" data-bs-toggle="modal"
                            data-bs-target="#labModal">
                            <i class="bi bi-plus-circle mx-1"></i> Agregar
                        </button>
                    </div>
                </div>
            </div>
            <div class="card-body bg-secondary-subtle" style="height: 350px; overflow-y: auto">
                <div class="accordion accordion-flush" id="accordionFlush">
                    @for (lab of labs; track lab.lab_id) {
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading-{{ lab.lab_id }}">
                            <button class="accordion-button collapsed bg-warning-subtle" type="button"
                                data-bs-toggle="collapse" [attr.data-bs-target]="'#collapse-' + lab.lab_id"
                                aria-expanded="false" [attr.aria-controls]="'collapse-' + lab.lab_id">
                                {{ lab.name + " - " + lab.campus }}
                            </button>
                        </h2>
                        <div id="collapse-{{ lab.lab_id }}" class="accordion-collapse collapse"
                            data-bs-parent="#accordionFlush">
                            <div class="accordion-body" style="min-height: 150px">
                                <div class="d-flex flex-wrap gap-3">
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Nombre:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            capitalizeString(lab.name)
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Especialización:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            capitalizeString(lab.specialization)
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Capacidad:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            lab.capacity + " personas"
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Institución:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            capitalizeString(lab.institution)
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Campus:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            lab.campus
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Ubicación:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            capitalizeString(lab.location)
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Creado el:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            formatDate(lab.creation_date)
                                            }}</span>
                                    </div>
                                    <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                        style="min-width: 250px">
                                        <span class="fw-bold">Descripción:</span><br />
                                        <span class="border-bottom pb-1 d-inline-block">{{
                                            capitalizeString(lab.description)
                                            }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- LAB MODAL -->
    <div class="modal fade" id="labModal" tabindex="-1" aria-labelledby="labModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-warning-subtle">
                    <h1 class="modal-title fs-5">
                        Agregar Laboratorio <i class="bi bi-building-fill-add"></i>
                    </h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>

                <div class="modal-body">
                    <form [formGroup]="labForm" (submit)="createLab()">
                        <div class="mb-3">
                            <label for="labName" class="form-label">Nombre <i class="bi bi-tag-fill"></i></label>
                            <input type="text" class="form-control" id="labName" formControlName="name" />
                            <div class="form-text">
                                Ejemplo: Laboratorio de Química Orgánica
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="labInstitution" class="form-label">Institución <i
                                    class="bi bi-buildings-fill"></i></label>
                            <select id="labInstitution" class="form-select" formControlName="institution">
                                <option value="" disabled selected>
                                    Selecciona una institución
                                </option>
                                <option value="Universidad de Guadalajara">
                                    Universidad de Guadalajara
                                </option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="labCampus" class="form-label">Campus <i class="bi bi-building-fill"></i></label>
                            <select id="labCampus" class="form-select" formControlName="campus">
                                <option value="" disabled selected>Selecciona un campus</option>
                                <option value="CUCEI">CUCEI</option>
                                <option value="CUCS">CUCS</option>
                                <option value="CUCEA">CUCEA</option>
                                <option value="CUSUR">CUSUR</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="labLocation" class="form-label">Ubicación <i class="bi bi-geo-fill"></i></label>
                            <input type="text" class="form-control" id="labLocation" formControlName="location" />
                            <div class="form-text">
                                Ejemplo: Edificio anexo a Rectoría, planta baja.
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="labDescription" class="form-label">Descripción <i
                                    class="bi bi-info-circle-fill"></i></label>
                            <textarea class="form-control" id="labDescription" rows="3"
                                formControlName="description"></textarea>
                            <div class="form-text">
                                Ejemplo: Laboratorio enfocado en estudios de neurociencia
                                cognitiva, psicología experimental y modelos computacionales del
                                cerebro.
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="labCapacity" class="form-label">Capacidad <i
                                    class="bi bi-person-raised-hand"></i></label>
                            <input type="number" min="1" max="100" placeholder="1" class="form-control" id="labCapacity"
                                formControlName="capacity" />
                            <div class="form-text">
                                Ejemplo: Número total de personas que pueden estar
                                simultáneamente en el laboratorio.
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="labSpecialization" class="form-label">Especialización <i
                                    class="bi bi-search"></i></label>
                            <select id="labSpecialization" class="form-select" formControlName="specialization">
                                <option value="" disabled selected>
                                    Selecciona una especialización
                                </option>
                                <option>Química</option>
                                <option>Física</option>
                                <option>Alimentos</option>
                                <option>Fotónica</option>
                                <option>Computación</option>
                                <option>Biotecnología</option>
                                <option>Ingeniería Biomédica</option>
                                <option>Microbiología</option>
                                <option>Robótica</option>
                                <option>Inteligencia Artificial</option>
                            </select>
                            <div class="form-text">
                                Selecciona el área principal de enfoque del laboratorio.
                            </div>
                        </div>

                        @if (labMessage != '') {
                        <div class="alert alert-warning" role="alert">
                            {{ labMessage }}
                        </div>
                        }
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-warning w-100">
                                Crear<i class="bi bi-plus-circle mx-1"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    }
</ng-template>

<ng-template #information>
    <div class="row gy-3">
        <!-- Columna de la imagen -->
        <div class="col-md-6 d-flex flex-column align-items-center justify-content-center">
            @if (user?.profile_image) {
            <img [src]="'data:image/png;base64,' + user?.profile_image"
                class="rounded-circle border border-3 border-light shadow-sm" width="250" height="250" alt="Avatar"
                style="object-fit: cover" />
            }
            <img src="/images/icon.png" class="rounded-circle border border-3 border-light shadow-sm" width="250"
                height="250" alt="Avatar" style="object-fit: cover" />
            <hr />
            <h6 class="">{{ "@" + user?.username }}</h6>
            <h4 class="fw-bold mb-0">
                {{ user?.first_name + " " + user?.last_name }}
            </h4>
            @if (isAdmin) {
            <span class="badge text-bg-success">Admin</span>
            } @else {
            <span class="badge text-bg-primary">Estudiante</span>
            }
            <h6 class="my-1">{{ user?.institution }}</h6>
        </div>

        <!-- Columna de información -->
        <div class="col-md-6 d-flex flex-column align-items-center justify-content-center">
            <table class="table table-warning table-hover">
                <tbody>
                    <tr>
                        <th scope="row">Usuario</th>
                        <td>{{ user?.username }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Nombre</th>
                        <td>{{ user?.first_name + " " + user?.last_name }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Institución</th>
                        <td>{{ user?.institution }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Campus</th>
                        <td>{{ user?.campus }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Carrera</th>
                        <td>{{ user?.student_carreer }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Codigo</th>
                        <td>{{ user?.student_code }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Correo</th>
                        <td>{{ user?.email }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Telefono</th>
                        <td>{{ user?.phone }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Miembro desde</th>
                        <td>{{ formatDate(user?.creation_date) }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</ng-template>

<ng-template #security>
    <div class="container">
        <div class="accordion" id="accountAccordion">
            <!-- Password Section -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingPassword">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapsePassword" aria-expanded="false"
                        aria-controls="collapsePassword">
                        Contraseña <i class="bi bi-key-fill mx-2"></i>
                    </button>
                </h2>
                <div id="collapsePassword" class="accordion-collapse collapse" aria-labelledby="headingPassword"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="passwordForm" (submit)="updatePassword()">
                            <div class="mb-3">
                                <label for="newPassword" class="form-label">Nueva contraseña</label>
                                <input type="password" class="form-control" id="newPassword"
                                    formControlName="newPassword" />
                                    <div class="form-text">Tu nueva contraseña debe tener al menos 8 caracteres.</div>

                            </div>
                            <div class="mb-3">
                                <label for="confirmPassword" class="form-label">Confirmar contraseña</label>
                                <input type="password" class="form-control" id="confirmPassword"
                                    formControlName="confirmPassword" />
                                    <div class="form-text">Repite la contraseña exactamente como la escribiste antes.</div>

                            </div>
                            @if (passwordMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ passwordMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!--Email Section -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingEmail">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseEmail" aria-expanded="false"
                        aria-controls="collapseEmail">
                        Correo <i class="bi bi-envelope-fill mx-2"></i>
                    </button>
                </h2>
                <div id="collapseEmail" class="accordion-collapse collapse" aria-labelledby="headingEmail"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="emailForm" (submit)="updateEmail()">
                            <div class="mb-3">
                                <label for="newEmail" class="form-label">Nuevo correo</label>
                                <input type="email" class="form-control" id="newEmail" formControlName="email" />
                                <div class="form-text">Ingresa tu correo electrónico institucional.</div>

                            </div>
                            @if (emailMessage != '') {
                                <div class="alert alert-warning" role="alert">
                                    {{ emailMessage }}
                                </div>
                                }
                                
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!--Phone Section-->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingPhone">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapsePhone" aria-expanded="false"
                        aria-controls="collapsePhone">
                        Teléfono <i class="bi bi-phone-fill mx-2"></i>
                    </button>
                </h2>
                <div id="collapsePhone" class="accordion-collapse collapse" aria-labelledby="headingPhone"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="phoneForm" (submit)="updatePhone()">
                            <div class="mb-3">
                                <label for="newPhone" class="form-label">Nuevo teléfono</label>
                                <input type="text" class="form-control" id="newPhone" formControlName="phone" />
                                <div class="form-text">Ingresa un número de 10 dígitos.</div>

                            </div>
                            @if (phoneMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ phoneMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Name -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingName">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseName" aria-expanded="false"
                        aria-controls="collapseName">
                        Name<i class="bi bi-file-post mx-2"></i>
                    </button>
                </h2>
                <div id="collapseName" class="accordion-collapse collapse" aria-labelledby="headingName"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="nameForm" (submit)="updateName()">
                            <div class="mb-3">
                                <label for="newName" class="form-label">Nuevo Nombre</label>
                                <input type="text" class="form-control" id="newName" formControlName="first_name" />
                                <div class="form-text">Escribe tu(s) nombre(s) iniciando con mayúscula.</div>
                            </div>

                            @if (nameMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ nameMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <!--Last Name-->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headinglastName">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapselastName" aria-expanded="false"
                        aria-controls="collapsePhone">
                        Apellido<i class="bi bi-file-post mx-2"></i>
                    </button>
                </h2>
                <div id="collapselastName" class="accordion-collapse collapse" aria-labelledby="headinglastName"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="lastNameForm" (submit)="updateLastName()">
                            <div class="mb-3">
                                <label for="newlastName" class="form-label">Nuevo Apellido</label>
                                <input type="text" class="form-control" formControlName="last_name" id="newlastName" />
                                <div class="form-text">Escribe tus apellido(s) con mayúscula inicial.</div>
                            </div>
                            @if (lastNameMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ lastNameMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Institution -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingInstitution">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseInstitution" aria-expanded="false"
                        aria-controls="collapseInstitution">
                        Institucion <i class="bi bi-buildings mx-2"></i>
                    </button>
                </h2>
                <div id="collapseInstitution" class="accordion-collapse collapse" aria-labelledby="headingInstitution"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="institutionForm" (submit)="updateInstitution()">
                            <div class="mb-3">
                                <label for="newInstitution" class="form-label">Nueva Institucion</label>
                                <select class="form-select" id="newInstitution" formControlName="institution" required>
                                    <option value="" selected>Seleciona tu Institucion</option>
                                    <option value="Universidad De Guadalajara">Universidad De Guadalajara</option>
                                </select>
                                <div class="form-text">Selecciona la institución a la que perteneces.</div>
                            </div>
                            @if (institutionMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ institutionMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Campus -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingCampus">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseCampus" aria-expanded="false"
                        aria-controls="collapseCampus">
                        Campus <i class="bi bi-building mx-2"></i>
                    </button>
                </h2>
                <div id="collapseCampus" class="accordion-collapse collapse" aria-labelledby="headingCampus"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="campusForm" (submit)="updateCampus()">
                            <div class="mb-3">
                                <label for="newCampus" class="form-label">Nuevo Campus</label>
                                <select class="form-select" id="newCampus" formControlName="campus" required>
                                    <option value="" selected>Seleciona tu Campus</option>
                                    <option value="CUCEI">CUCEI</option>
                                    <option value="CUCS">CUCS</option>
                                    <option value="CUCSH">CUCSH</option>
                                    <option value="CUCEA">CUCEA</option>
                                    <option value="CUCBA">CUCBA</option>
                                    <option value="CUAAD">CUAAD</option>
                                    <option value="CUALTOS">CUALTOS</option>
                                    <option value="CUC">CUC</option>
                                    <option value="CUCIENEGA">CUCIENEGA</option>
                                    <option value="CULAGOS">CULAGOS</option>
                                    <option value="CUCSUR">CUCSUR</option>
                                    <option value="CUNORTE">CUNORTE</option>
                                    <option value="CUSUR">CUSUR</option>
                                    <option value="CUVALLES">CUVALLES</option>
                                </select>
                                <div class="form-text">Elige el campus donde estás inscrito.</div>
                            </div>
                            @if (campusMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ campusMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Student Career Update -->
            <div class="accordion-item border-warning">
                <h2 class="accordion-header" id="headingCarreer">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseCarreer" aria-expanded="false"
                        aria-controls="collapseCarreer">
                        Carrera <i class="bi bi-backpack4 mx-2"></i>
                    </button>
                </h2>

                <div id="collapseCarreer" class="accordion-collapse collapse" aria-labelledby="headingCarreer"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="carreerForm" (submit)="updateCarreer()">
                            <div class="mb-3">
                                <label for="newCarreer" class="form-label">Nueva Carrera</label>
                                <select id="newCarreer" class="form-select" formControlName="student_carreer" required>
                                    <option value="" selected>Selecciona una carrera</option>
                                    <option value="Licenciatura en Física">
                                        Licenciatura en Física
                                    </option>
                                    <option value="Licenciatura en Matemáticas">
                                        Licenciatura en Matemáticas
                                    </option>
                                    <option value="Licenciatura en Química">
                                        Licenciatura en Química
                                    </option>
                                    <option value="Químico Farmacéutico Biólogo">
                                        Químico Farmacéutico Biólogo
                                    </option>
                                    <option value="Ingeniería en Ciencia de Materiales">
                                        Ingeniería en Ciencia de Materiales
                                    </option>
                                    <option value="Ingeniería Civil">Ingeniería Civil</option>
                                    <option value="Ingeniería en Alimentos y Biotecnología">
                                        Ingeniería en Alimentos y Biotecnología
                                    </option>
                                    <option value="Ingeniería en Topografía Geomática">
                                        Ingeniería en Topografía Geomática
                                    </option>
                                    <option value="Ingeniería Industrial">
                                        Ingeniería Industrial
                                    </option>
                                    <option value="Ingeniería Mecánica Eléctrica">
                                        Ingeniería Mecánica Eléctrica
                                    </option>
                                    <option value="Ingeniería Química">Ingeniería Química</option>
                                    <option value="Ingeniería en Logística y Transporte">
                                        Ingeniería en Logística y Transporte
                                    </option>
                                    <option value="Ingeniería Informática">
                                        Ingeniería Informática
                                    </option>
                                    <option value="Ingeniería Biomédica">
                                        Ingeniería Biomédica
                                    </option>
                                    <option value="Ingeniería en Computación">
                                        Ingeniería en Computación
                                    </option>
                                    <option value="Ingeniería en Electromovilidad y Autotrónica">
                                        Ingeniería en Electromovilidad y Autotrónica
                                    </option>
                                    <option value="Ingeniería en Electrónica y Sistemas Inteligentes">
                                        Ingeniería en Electrónica y Sistemas Inteligentes
                                    </option>
                                    <option value="Ingeniería Fotónica">
                                        Ingeniería Fotónica
                                    </option>
                                    <option value="Ingeniería en Mecatrónica Inteligente">
                                        Ingeniería en Mecatrónica Inteligente
                                    </option>
                                    <option value="Ingeniería Robótica">
                                        Ingeniería Robótica
                                    </option>
                                </select>
                                <div class="form-text">Selecciona la carrera que estás cursando o en la que estás inscrito.</div>
                            </div>
                            @if (carreerMessage != '') {
                            <div class="alert alert-warning" role="alert">
                                {{ carreerMessage }}
                            </div>
                            }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Code Update-->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingCode">
                    <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseCode" aria-expanded="false"
                        aria-controls="collapseCode">
                        Codigo <i class="bi bi-123 mx-2"></i>
                    </button>
                </h2>
                <div id="collapseCode" class="accordion-collapse collapse" aria-labelledby="headingCode"
                    data-bs-parent="#accountAccordion">
                    <div class="accordion-body">
                        <form [formGroup]="codeForm" (submit)="updateCode()">
                            <div class="mb-3">
                                <label for="newCode" class="form-label">Nuevo Codigo</label>
                                <input type="text" class="form-control" id="newCode" formControlName="student_code" />
                                <div class="form-text">Ingresa tu código de estudiante.</div>
                            </div>
                            @if (codeMessage != '') {
                                <div class="alert alert-warning" role="alert">
                                    {{ codeMessage }}
                                </div>
                                }
                            <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                Actualizar
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Birthday Update 
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingBirth">
                        <button class="accordion-button bg-warning text-white collapsed fw-bold" type="button"
                            data-bs-toggle="collapse" data-bs-target="#collapseBirth" aria-expanded="false"
                            aria-controls="collapseBirth">
                            Fecha de Nacimiento<i class="bi bi-phone-fill mx-2"></i>
                        </button>
                    </h2>
                    <div id="collapseBirth" class="accordion-collapse collapse" aria-labelledby="headingBith"
                        data-bs-parent="#accountAccordion">
                        <div class="accordion-body">
                            <form [formGroup]="birthForm" (submit)="updateBirth()">
                                <div class="mb-3">
                                    <label for="studentCareer" class="form-label">Carrera</label>
           
                                    <label for="newBirth" class="form-label">Nueva Fecha de Nacimiento</label>
                                    <input type="text" class="form-control" id="newBirth">
                                </div>
                                <button type="submit" class="btn btn-warning text-light w-100 fw-bold">
                                    Actualizar
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                -->
        </div>
    </div>
</ng-template>

<div class="container-lg ">
    <div class="card">
        <div class="card-header bg-warning-subtle">
            <h3>Reservaciones</h3>
        </div>
        <div class="card-body bg-secondary-subtle" style="height: 350px; overflow-y: auto">
            <div class="accordion accordion-flush" id="accordionFlush">
                @for (reserv of reservs; track reserv.user_id) {
                <div class="accordion-item">
                    <h2 class="accordion-header" id="heading-{{ reserv.user_id }}">
                        <button class="accordion-button collapsed bg-warning-subtle" type="button"
                            data-bs-toggle="collapse" [attr.data-bs-target]="'#collapse-' + reserv.reserv_id"
                            aria-expanded="false" [attr.aria-controls]="'collapse-' + reserv.reserv_id">
                            {{ reserv.reserv_date }}
                        </button>
                    </h2>
                    <div id="collapse-{{ reserv.reserv_id }}" class="accordion-collapse collapse"
                        data-bs-parent="#accordionFlush">
                        <div class="accordion-body" style="min-height: 150px">
                            <div class="d-flex flex-wrap gap-3">
                                <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                    style="min-width: 250px">
                                    <span class="fw-bold">Hora de inicio:</span><br />
                                    <span class="border-bottom pb-1 d-inline-block">{{
                                        capitalizeString(reserv.start_time)
                                        }}</span>
                                </div>
                                <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                    style="min-width: 250px">
                                    <span class="fw-bold">Hora de finalizacion:</span><br />
                                    <span class="border-bottom pb-1 d-inline-block">{{
                                        capitalizeString(reserv.end_time)
                                        }}</span>
                                </div>
                                <div class="card bg-warning-subtle border border-primary rounded p-3 m-1 flex-fill text-break"
                                    style="min-width: 250px">
                                    <span class="fw-bold">Estatus de la reservacion:</span><br />
                                    <span class="border-bottom pb-1 d-inline-block">{{
                                        capitalizeString(reserv.status)
                                        }}</span>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>
    </div>

</div>
<ng-template #loading>
    <div class="col text-center py-5">
        <div class="spinner-border text-dark" role="status">
            <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3">Cargando...</p>
    </div>
</ng-template>